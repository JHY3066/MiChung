공행성 예측 모델 개발 현황 보고서 (v2)

날짜: 2025년 11월 16일
목표: 대회 평가 산식(F1 + NMAE)을 기반으로 2025년 8월 무역량을 예측하고, 리더보드 점수(현재 0.1653)를 극대화

1. 프로젝트 개요

본 프로젝트의 목표는 2025년 8월의 선후행 item_id 쌍 간의 무역량을 예측하는 것입니다.

대회 평가 산식은 Score = 0.6 × F1 + 0.4 × (1 − NMAE)로, 두 가지 과제를 동시에 해결해야 합니다.

공행성 쌍 선별 (F1 Score, 60%): '진짜' 관계가 있는 item_id 쌍을 얼마나 잘 찾아내는가? (value > 0로 예측)

무역량 예측 (NMAE, 40%): 찾아낸 쌍의 2025년 8월 무역량을 얼마나 정확히 예측하는가?

2. 초기 접근 (hs4 기준) 및 전략 수정

프로젝트 초기에는 hs4 (품목 카테고리) 기준으로 데이터를 집계하여 분석했습니다.

ARIMAX 모델: 데이터의 0이 많은 '희소성(Sparsity)' 특성으로 인해 '가짜 상관관계'를 탐지, 모델이 선행 변수를 무시하고 평균값만 예측하는 한계에 부딪혔습니다.

XGBoost 모델: hs4 기준 36개의 적은 샘플에도 불구하고, 선행 변수(A_lag_1)를 예측에 가장 중요한 1위 특징으로 사용하는 데 성공했습니다.

이후 sample_submission.csv와 평가 산식을 확인하며, 분석 단위를 hs4가 아닌 item_id로 변경하고, F1 점수를 고려하는 최종 전략을 수립했습니다.

3. 최종 전략: 'CCF 필터 + XGBoost'

F1 Score(선별)와 NMAE(예측) 문제를 동시에 해결하기 위해, 1) CCF를 필터로, 2) XGBoost를 예측기로 사용하는 2-Stage 모델을 개발했습니다.

1단계 (F1 필터): sample_submission.csv의 모든 쌍에 대해 CCF(교차 상관 분석)를 실행합니다.

2단계 (선별): 상관계수가 임계값(Threshold) 미만이면 value = 0 (관계 없음)으로 예측합니다.

3단계 (NMAE 예측): 상관계수가 임계값 이상이면 XGBoost 모델을 훈련시켜 value > 0 (관계 있음) 값을 예측합니다.

4. 모델 개선 과정 (v1 $\rightarrow$ v2)

이 2-Stage 모델을 기반으로 리더보드 점수를 개선하기 위해 다음과 같은 시도를 진행했습니다.

4.1. 모델 v1 (Baseline)

F1 전략: CORR_THRESHOLD = 0.3 (상관계수 0.3 이상만 예측)

NMAE 전략: XGBoost (max_depth=3) (단순한 모델)

결과: 리더보드 점수 0.1558점

4.2. 모델 v2 (Current)

v1의 낮은 점수(0.1558)는 F1 점수(특히 Recall) 또는 NMAE 점수가 낮기 때문이라고 판단했습니다.

가설: F1 점수를 높이기 위해 더 많은 쌍을 '관계 있음'으로 예측(Recall 향상)하고, NMAE를 높이기 위해 모델을 더 정교하게 만들 필요가 있다.

F1 전략 (수정): CORR_THRESHOLD = 0.3 $\rightarrow$ 0.25 (필터 기준 완화)

NMAE 전략 (수정): max_depth = 3 $\rightarrow$ 5 (모델 정교화)

결과: 리더보드 점수 0.1653점

5. 현황 분석 및 다음 단계

분석: v2 모델이 v1보다 약 0.01점 상승했습니다. 이는 CCF 임계값을 낮추고(0.25) 모델 복잡도를 높인(max_depth 5) 전략이 올바른 방향이었음을 시사합니다.

핵심 단서: 타 조에서 약 2500쌍을 예측하여 0.385점의 고득점을 획득했습니다.

결론: 우리의 0.1653점은 F1 Score가 여전히 낮기 때문이며, '진짜' 공행성 쌍 2500개에 도달하기 위해 CORR_THRESHOLD = 0.25가 여전히 너무 높다고 판단됩니다.

다음 단계 (v3): F1 Score(Recall)를 더욱 높여 2500쌍에 근접하기 위해, CCF 임계값을 0.20으로 더 낮추는 v3 모델 테스트를 준비 중입니다.
